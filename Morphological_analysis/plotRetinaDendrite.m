function plotRetinaDendrite(DendriteData_CalField,Name)
%PLOT plots the neuron morphology in a 2-dim space.
% INPUT:
%     DendriteData_CalField - a  structure added calculated density map matrix.
%     Name - RGCs morphological name;

hold on;

dendrites = DendriteData_CalField.Dendrites;
soma = DendriteData_CalField.Soma;
numDen = length(dendrites);

for i = 1:numDen
    dendrite = dendrites{1,i};
    % plot the points.
    scatter(dendrite(:,1),dendrite(:,2),pi*(1/2).^2,'b','filled');
    % plot the axon curve.
    for j = 2:size(dendrite,1)
        plot([dendrite(dendrite(j,3),1),dendrite(j,1)],[dendrite(dendrite(j,3),2),dendrite(j,2)],'b','LineWidth',1);
    end
end

% plot the Soma and fill it.
fill(soma(:,1),soma(:,2),'k');

title(Name(1:end-4));
axis equal;
xlim([-350 350])
ylim([-350 350])
axis off
set(gca,'XMinorTick','on','YMinorTick','on','XMinorGrid','on','YMinorGrid','on','MinorGridLineStyle','-')
hold off;box on;

mycolor = [[0.329411764705882,0.329411764705882,0.729411764705882;0.329329663679563,0.335269517163922,0.732610043921627;0.329247562653244,0.341127269621963,0.735808323137371;0.329165461626925,0.346985022080003,0.739006602353116;0.329083360600606,0.352842774538043,0.742204881568860;0.329001259574287,0.358700526996083,0.745403160784605;0.328919158547968,0.364558279454123,0.748601440000349;0.328837057521648,0.370416031912163,0.751799719216094;0.328754956495329,0.376273784370203,0.754997998431838;0.328672855469010,0.382131536828243,0.758196277647583;0.328590754442691,0.387989289286283,0.761394556863327;0.328508653416372,0.393847041744323,0.764592836079072;0.328426552390053,0.399704794202363,0.767791115294816;0.328344451363734,0.405562546660404,0.770989394510561;0.328262350337415,0.411420299118444,0.774187673726305;0.328180249311095,0.417278051576484,0.777385952942050;0.328098148284776,0.423135804034524,0.780584232157794;0.328016047258457,0.428993556492564,0.783782511373539;0.327933946232138,0.434851308950604,0.786980790589283;0.327851845205819,0.440709061408644,0.790179069805028;0.327769744179500,0.446566813866684,0.793377349020772;0.327687643153181,0.452424566324724,0.796575628236517;0.327605542126862,0.458282318782764,0.799773907452261;0.327523441100542,0.464140071240804,0.802972186668006;0.327441340074223,0.469997823698844,0.806170465883750;0.327359239047904,0.475855576156884,0.809368745099495;0.327277138021585,0.481713328614925,0.812567024315239;0.327195036995266,0.487571081072965,0.815765303530984;0.327112935968947,0.493428833531005,0.818963582746728;0.327030834942628,0.499286585989045,0.822161861962473;0.326948733916309,0.505144338447085,0.825360141178217;0.326866632889989,0.511002090905125,0.828558420393962;0.326784531863670,0.516859843363165,0.831756699609706;0.326702430837351,0.522717595821205,0.834954978825451;0.326620329811032,0.528575348279245,0.838153258041195;0.326538228784713,0.534433100737285,0.841351537256940;0.326456127758394,0.540290853195325,0.844549816472684;0.326374026732075,0.546148605653366,0.847748095688429;0.326291925705756,0.552006358111406,0.850946374904173;0.326209824679436,0.557864110569446,0.854144654119918;0.326127723653117,0.563721863027486,0.857342933335662;0.326045622626798,0.569579615485526,0.860541212551407;0.325963521600479,0.575437367943566,0.863739491767151;0.325881420574160,0.581295120401606,0.866937770982896;0.325799319547841,0.587152872859646,0.870136050198640;0.325717218521522,0.593010625317686,0.873334329414385;0.325635117495202,0.598868377775726,0.876532608630129;0.325553016468883,0.604726130233766,0.879730887845874;0.325470915442564,0.610583882691806,0.882929167061618;0.325388814416245,0.616441635149847,0.886127446277363;0.325306713389926,0.622299387607887,0.889325725493107;0.325224612363607,0.628157140065927,0.892524004708852;0.326389293633418,0.634379950162468,0.892738476972599;0.327553974903229,0.640602760259009,0.892952949236346;0.328718656173040,0.646825570355549,0.893167421500093;0.329883337442851,0.653048380452090,0.893381893763840;0.331048018712662,0.659271190548631,0.893596366027587;0.332212699982473,0.665494000645172,0.893810838291335;0.333377381252284,0.671716810741713,0.894025310555082;0.334542062522095,0.677939620838254,0.894239782818829;0.335706743791907,0.684162430934795,0.894454255082576;0.336871425061718,0.690385241031336,0.894668727346323;0.338036106331529,0.696608051127876,0.894883199610070;0.339200787601340,0.702830861224417,0.895097671873817;0.340365468871151,0.709053671320958,0.895312144137564;0.341530150140962,0.715276481417499,0.895526616401312;0.342694831410773,0.721499291514040,0.895741088665059;0.343859512680584,0.727722101610581,0.895955560928806;0.345024193950395,0.733944911707122,0.896170033192553;0.346188875220206,0.740167721803663,0.896384505456300;0.347353556490017,0.746390531900203,0.896598977720047;0.348518237759828,0.752613341996744,0.896813449983794;0.349682919029639,0.758836152093285,0.897027922247542;0.350847600299451,0.765058962189826,0.897242394511289;0.352012281569262,0.771281772286367,0.897456866775036;0.353176962839073,0.777504582382908,0.897671339038783;0.354341644108884,0.783727392479449,0.897885811302530;0.355506325378695,0.789950202575990,0.898100283566277;0.356671006648506,0.796173012672531,0.898314755830024;0.357835687918317,0.802395822769071,0.898529228093771;0.359000369188128,0.808618632865612,0.898743700357519;0.360165050457939,0.814841442962153,0.898958172621266;0.361329731727750,0.821064253058694,0.899172644885013;0.362494412997561,0.827287063155235,0.899387117148760;0.363659094267372,0.833509873251776,0.899601589412507;0.364823775537183,0.839732683348317,0.899816061676254;0.365988456806994,0.845955493444858,0.900030533940001;0.367153138076806,0.852178303541399,0.900245006203749;0.368317819346617,0.858401113637939,0.900459478467496;0.369482500616428,0.864623923734480,0.900673950731243;0.370647181886239,0.870846733831021,0.900888422994990;0.371811863156050,0.877069543927562,0.901102895258737;0.372976544425861,0.883292354024103,0.901317367522484;0.374141225695672,0.889515164120644,0.901531839786231;0.375305906965483,0.895737974217185,0.901746312049978;0.376470588235294,0.901960784313726,0.901960784313726;0.386213235294118,0.903492647058824,0.887867647058824;0.395955882352941,0.905024509803922,0.873774509803922;0.405698529411765,0.906556372549020,0.859681372549020;0.415441176470588,0.908088235294118,0.845588235294118;0.425183823529412,0.909620098039216,0.831495098039216;0.434926470588235,0.911151960784314,0.817401960784314;0.444669117647059,0.912683823529412,0.803308823529412;0.454411764705882,0.914215686274510,0.789215686274510;0.464154411764706,0.915747549019608,0.775122549019608;0.473897058823529,0.917279411764706,0.761029411764706;0.483639705882353,0.918811274509804,0.746936274509804;0.493382352941177,0.920343137254902,0.732843137254902;0.503125000000000,0.921875000000000,0.718750000000000;0.512867647058824,0.923406862745098,0.704656862745098;0.522610294117647,0.924938725490196,0.690563725490196;0.532352941176471,0.926470588235294,0.676470588235294;0.542095588235294,0.928002450980392,0.662377450980392;0.551838235294118,0.929534313725490,0.648284313725490;0.561580882352941,0.931066176470588,0.634191176470588;0.571323529411765,0.932598039215686,0.620098039215686;0.581066176470588,0.934129901960784,0.606004901960784;0.590808823529412,0.935661764705882,0.591911764705882;0.600551470588235,0.937193627450980,0.577818627450980;0.610294117647059,0.938725490196078,0.563725490196078;0.620036764705882,0.940257352941177,0.549632352941176;0.629779411764706,0.941789215686275,0.535539215686275;0.639522058823529,0.943321078431373,0.521446078431373;0.649264705882353,0.944852941176471,0.507352941176471;0.659007352941176,0.946384803921569,0.493259803921569;0.668750000000000,0.947916666666667,0.479166666666667;0.678492647058824,0.949448529411765,0.465073529411765;0.688235294117647,0.950980392156863,0.450980392156863;0.697977941176471,0.952512254901961,0.436887254901961;0.707720588235294,0.954044117647059,0.422794117647059;0.717463235294118,0.955575980392157,0.408700980392157;0.727205882352941,0.957107843137255,0.394607843137255;0.736948529411765,0.958639705882353,0.380514705882353;0.746691176470588,0.960171568627451,0.366421568627451;0.756433823529412,0.961703431372549,0.352328431372549;0.766176470588235,0.963235294117647,0.338235294117647;0.775919117647059,0.964767156862745,0.324142156862745;0.785661764705882,0.966299019607843,0.310049019607843;0.795404411764706,0.967830882352941,0.295955882352941;0.805147058823529,0.969362745098039,0.281862745098039;0.814889705882353,0.970894607843137,0.267769607843137;0.824632352941177,0.972426470588235,0.253676470588235;0.834375000000000,0.973958333333333,0.239583333333333;0.844117647058824,0.975490196078431,0.225490196078431;0.853860294117647,0.977022058823529,0.211397058823529;0.863602941176471,0.978553921568627,0.197303921568627;0.873345588235294,0.980085784313726,0.183210784313726;0.883088235294118,0.981617647058824,0.169117647058823;0.892830882352941,0.983149509803922,0.155024509803922;0.902573529411765,0.984681372549020,0.140931372549020;0.912316176470588,0.986213235294118,0.126838235294118;0.922058823529412,0.987745098039216,0.112745098039216;0.931801470588235,0.989276960784314,0.0986519607843137;0.941544117647059,0.990808823529412,0.0845588235294118;0.951286764705882,0.992340686274510,0.0704656862745098;0.961029411764706,0.993872549019608,0.0563725490196079;0.970772058823530,0.995404411764706,0.0422794117647058;0.980514705882353,0.996936274509804,0.0281862745098039;0.990257352941176,0.998468137254902,0.0140931372549019;1,1,0;1,0.984375000000000,0;1,0.968750000000000,0;1,0.953125000000000,0;1,0.937500000000000,0;1,0.921875000000000,0;1,0.906250000000000,0;1,0.890625000000000,0;1,0.875000000000000,0;1,0.859375000000000,0;1,0.843750000000000,0;1,0.828125000000000,0;1,0.812500000000000,0;1,0.796875000000000,0;1,0.781250000000000,0;1,0.765625000000000,0;1,0.750000000000000,0;1,0.734375000000000,0;1,0.718750000000000,0;1,0.703125000000000,0;1,0.687500000000000,0;1,0.671875000000000,0;1,0.656250000000000,0;1,0.640625000000000,0;1,0.625000000000000,0;1,0.609375000000000,0;1,0.593750000000000,0;1,0.578125000000000,0;1,0.562500000000000,0;1,0.546875000000000,0;1,0.531250000000000,0;1,0.515625000000000,0;1,0.500000000000000,0;1,0.484375000000000,0;1,0.468750000000000,0;1,0.453125000000000,0;1,0.437500000000000,0;1,0.421875000000000,0;1,0.406250000000000,0;1,0.390625000000000,0;1,0.375000000000000,0;1,0.359375000000000,0;1,0.343750000000000,0;1,0.328125000000000,0;1,0.312500000000000,0;1,0.296875000000000,0;1,0.281250000000000,0;1,0.265625000000000,0;1,0.250000000000000,0;1,0.234375000000000,0;1,0.218750000000000,0;1,0.203125000000000,0;1,0.187500000000000,0;1,0.171875000000000,0;1,0.156250000000000,0;1,0.140625000000000,0;1,0.125000000000000,0;1,0.109375000000000,0;1,0.0937500000000000,0;1,0.0781250000000000,0;1,0.0625000000000000,0;1,0.0468750000000000,0;1,0.0312500000000000,0;1,0.0156250000000000,0;1,0,0;0.984375000000000,0,0;0.968750000000000,0,0;0.953125000000000,0,0;0.937500000000000,0,0;0.921875000000000,0,0;0.906250000000000,0,0;0.890625000000000,0,0;0.875000000000000,0,0;0.859375000000000,0,0;0.843750000000000,0,0;0.828125000000000,0,0;0.812500000000000,0,0;0.796875000000000,0,0;0.781250000000000,0,0;0.765625000000000,0,0;0.750000000000000,0,0;0.734375000000000,0,0;0.718750000000000,0,0;0.703125000000000,0,0;0.687500000000000,0,0;0.671875000000000,0,0;0.656250000000000,0,0;0.640625000000000,0,0;0.625000000000000,0,0;0.609375000000000,0,0;0.593750000000000,0,0;0.578125000000000,0,0;0.562500000000000,0,0;0.546875000000000,0,0;0.531250000000000,0,0;0.515625000000000,0,0;0.500000000000000,0,0]];
colormap(mycolor);
end

